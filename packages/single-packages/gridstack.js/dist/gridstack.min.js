!function(t,e){var i={is_intercepted:function(t,e){return!(t.x+t.width<=e.x||e.x+e.width<=t.x||t.y+t.height<=e.y||e.y+e.height<=t.y)},sort:function(t,i,n){return n=n||e.chain(t).map(function(t){return t.x+t.width}).max().value(),i=-1!=i?1:-1,e.sortBy(t,function(t){return i*(t.x+t.y*n)})},create_stylesheet:function(){var t=document.createElement("style");return t.appendChild(document.createTextNode("")),document.head.appendChild(t),t.sheet},toBool:function(t){return"boolean"==typeof t?t:"string"==typeof t?(t=t.toLowerCase(),!(""==t||"no"==t||"false"==t||"0"==t)):Boolean(t)}},n=0,o=function(t,e,i,n,o){this.width=t,this["float"]=i||!1,this.height=n||0,this.nodes=o||[],this.onchange=e||function(){}};o.prototype._fix_collisions=function(t){this._sort_nodes(-1);var n=t,o=Boolean(e.find(this.nodes,function(t){return t.locked}));for(this["float"]||o||(n={x:0,y:t.y,width:this.width,height:t.height});;){var a=e.find(this.nodes,function(e){return e!=t&&i.is_intercepted(e,n)},this);if("undefined"==typeof a)return;this.move_node(a,a.x,t.y+t.height,a.width,a.height,!0)}},o.prototype._sort_nodes=function(t){this.nodes=i.sort(this.nodes,t,this.width)},o.prototype._pack_nodes=function(){this._sort_nodes(),this["float"]?e.each(this.nodes,function(t){if(!t._updating&&"undefined"!=typeof t._orig_y&&t.y!=t._orig_y)for(var n=t.y;n>=t._orig_y;){var o=e.chain(this.nodes).find(function(e){return t!=e&&i.is_intercepted({x:t.x,y:n,width:t.width,height:t.height},e)}).value();o||(t._dirty=!0,t.y=n),--n}},this):e.each(this.nodes,function(t,n){if(!t.locked)for(;t.y>0;){var o=t.y-1,a=0==n;if(n>0){var h=e.chain(this.nodes).first(n).find(function(e){return i.is_intercepted({x:t.x,y:o,width:t.width,height:t.height},e)}).value();a="undefined"==typeof h}if(!a)break;t._dirty=t.y!=o,t.y=o}},this)},o.prototype._prepare_node=function(t,i){return t=e.defaults(t||{},{width:1,height:1,x:0,y:0}),t.x=parseInt(""+t.x),t.y=parseInt(""+t.y),t.width=parseInt(""+t.width),t.height=parseInt(""+t.height),t.auto_position=t.auto_position||!1,t.no_resize=t.no_resize||!1,t.no_move=t.no_move||!1,t.width>this.width?t.width=this.width:t.width<1&&(t.width=1),t.height<1&&(t.height=1),t.x<0&&(t.x=0),t.x+t.width>this.width&&(i?t.width=this.width-t.x:t.x=this.width-t.width),t.y<0&&(t.y=0),t},o.prototype._notify=function(){var t=Array.prototype.slice.call(arguments,1).concat(this.get_dirty_nodes());t=t.concat(this.get_dirty_nodes()),this.onchange(t)},o.prototype.clean_nodes=function(){e.each(this.nodes,function(t){t._dirty=!1})},o.prototype.get_dirty_nodes=function(){return e.filter(this.nodes,function(t){return t._dirty})},o.prototype.add_node=function(t){if(t=this._prepare_node(t),"undefined"!=typeof t.max_width&&(t.width=Math.min(t.width,t.max_width)),"undefined"!=typeof t.max_height&&(t.height=Math.min(t.height,t.max_height)),"undefined"!=typeof t.min_width&&(t.width=Math.max(t.width,t.min_width)),"undefined"!=typeof t.min_height&&(t.height=Math.max(t.height,t.min_height)),t._id=++n,t._dirty=!0,t.auto_position){this._sort_nodes();for(var o=0;;++o){var a=o%this.width,h=Math.floor(o/this.width);if(!(a+t.width>this.width||e.find(this.nodes,function(e){return i.is_intercepted({x:a,y:h,width:t.width,height:t.height},e)}))){t.x=a,t.y=h;break}}}return this.nodes.push(t),this._fix_collisions(t),this._pack_nodes(),this._notify(),t},o.prototype.remove_node=function(t){t._id=null,this.nodes=e.without(this.nodes,t),this._pack_nodes(),this._notify(t)},o.prototype.can_move_node=function(t,i,n,a,h){var s=Boolean(e.find(this.nodes,function(t){return t.locked}));if(!this.height&&!s)return!0;var d,r=new o(this.width,null,this["float"],0,e.map(this.nodes,function(e){return e==t?d=$.extend({},e):$.extend({},e)}));r.move_node(d,i,n,a,h);var _=!0;return s&&(_&=!Boolean(e.find(r.nodes,function(t){return t!=d&&Boolean(t.locked)&&Boolean(t._dirty)}))),this.height&&(_&=r.get_grid_height()<=this.height),_},o.prototype.can_be_placed_with_respect_to_height=function(t){if(!this.height)return!0;var i=new o(this.width,null,this["float"],0,e.map(this.nodes,function(t){return $.extend({},t)}));return i.add_node(t),i.get_grid_height()<=this.height},o.prototype.move_node=function(t,e,i,n,o,a){if("number"!=typeof e&&(e=t.x),"number"!=typeof i&&(i=t.y),"number"!=typeof n&&(n=t.width),"number"!=typeof o&&(o=t.height),"undefined"!=typeof t.max_width&&(n=Math.min(n,t.max_width)),"undefined"!=typeof t.max_height&&(o=Math.min(o,t.max_height)),"undefined"!=typeof t.min_width&&(n=Math.max(n,t.min_width)),"undefined"!=typeof t.min_height&&(o=Math.max(o,t.min_height)),t.x==e&&t.y==i&&t.width==n&&t.height==o)return t;var h=t.width!=n;return t._dirty=!0,t.x=e,t.y=i,t.width=n,t.height=o,t=this._prepare_node(t,h),this._fix_collisions(t),a||(this._pack_nodes(),this._notify()),t},o.prototype.get_grid_height=function(){return e.reduce(this.nodes,function(t,e){return Math.max(t,e.y+e.height)},0)},o.prototype.begin_update=function(t){e.each(this.nodes,function(t){t._orig_y=t.y}),t._updating=!0},o.prototype.end_update=function(){var t=e.find(this.nodes,function(t){return t._updating});t&&(t._updating=!1)};var a=function(t,n){var a,h=this;if(this.container=$(t),this.opts=e.defaults(n||{},{width:parseInt(this.container.attr("data-gs-width"))||12,height:parseInt(this.container.attr("data-gs-height"))||0,item_class:"grid-stack-item",placeholder_class:"grid-stack-placeholder",handle:".grid-stack-item-content",cell_height:60,vertical_margin:20,auto:!0,min_width:768,"float":!1,_class:"grid-stack-"+(1e4*Math.random()).toFixed(0),animate:Boolean(this.container.attr("data-gs-animate"))||!1,always_show_resize_handle:n.always_show_resize_handle||!1}),this.container.addClass(this.opts._class),this._styles=i.create_stylesheet(),this._styles._max=0,this.grid=new o(this.opts.width,function(t){var i=0;e.each(t,function(t){null==t._id?t.el.remove():(t.el.attr("data-gs-x",t.x).attr("data-gs-y",t.y).attr("data-gs-width",t.width).attr("data-gs-height",t.height),i=Math.max(i,t.y+t.height))}),h._update_styles(i+10)},this.opts["float"],this.opts.height),this.opts.auto){var s=[];this.container.find("."+this.opts.item_class).each(function(t,e){e=$(e),s.push({el:e,i:parseInt(e.attr("data-gs-x"))+parseInt(e.attr("data-gs-y"))*parseInt(e.attr("data-gs-width"))})}),e.chain(s).sortBy(function(t){return t.i}).each(function(t){h._prepare_element(t.el)})}this.set_animation(this.opts.animate),this.placeholder=$('<div class="'+this.opts.placeholder_class+" "+this.opts.item_class+'"><div class="placeholder-content" /></div>').hide(),this.container.append(this.placeholder),this.container.height(this.grid.get_grid_height()*(this.opts.cell_height+this.opts.vertical_margin)-this.opts.vertical_margin);var d=function(){if(h._is_one_column_mode()){if(a)return;a=!0,h.grid._sort_nodes(),e.each(h.grid.nodes,function(t){h.container.append(t.el),t.no_move||t.el.draggable("disable"),t.no_resize||t.el.resizable("disable")})}else{if(!a)return;a=!1,e.each(h.grid.nodes,function(t){t.no_move||t.el.draggable("enable"),t.no_resize||t.el.resizable("enable")})}};$(window).resize(d),d()};a.prototype._update_styles=function(t){if("undefined"==typeof t){for(t=this._styles._max,this._styles._max=0;this._styles.rules.length;)this._styles.removeRule(0);this._update_container_height()}if(t>this._styles._max){for(var e=this._styles._max;t>e;++e){var i;i="."+this.opts._class+" ."+this.opts.item_class+'[data-gs-height="'+(e+1)+'"] { height: '+(this.opts.cell_height*(e+1)+this.opts.vertical_margin*e)+"px; }",this._styles.insertRule(i,e),i="."+this.opts._class+" ."+this.opts.item_class+'[data-gs-y="'+e+'"] { top: '+(this.opts.cell_height*e+this.opts.vertical_margin*e)+"px; }",this._styles.insertRule(i,e)}this._styles._max=t}},a.prototype._update_container_height=function(){this.container.height(this.grid.get_grid_height()*(this.opts.cell_height+this.opts.vertical_margin)-this.opts.vertical_margin)},a.prototype._is_one_column_mode=function(){return $(window).width()<=this.opts.min_width},a.prototype._prepare_element=function(t){var e=this;t=$(t),t.addClass(this.opts.item_class);var n=e.grid.add_node({x:t.attr("data-gs-x"),y:t.attr("data-gs-y"),width:t.attr("data-gs-width"),height:t.attr("data-gs-height"),max_width:t.attr("data-gs-max-width"),min_width:t.attr("data-gs-min-width"),max_height:t.attr("data-gs-max-height")||100,min_height:t.attr("data-gs-min-height"),auto_position:i.toBool(t.attr("data-gs-auto-position")),no_resize:i.toBool(t.attr("data-gs-no-resize")),no_move:i.toBool(t.attr("data-gs-no-move")),locked:i.toBool(t.attr("data-gs-locked")),el:t});t.data("_gridstack_node",n);var o,a,h=function(){var t=$(this);e.grid.clean_nodes(),e.grid.begin_update(n),o=Math.ceil(t.outerWidth()/t.attr("data-gs-width")),a=e.opts.cell_height+e.opts.vertical_margin,e.placeholder.attr("data-gs-x",t.attr("data-gs-x")).attr("data-gs-y",t.attr("data-gs-y")).attr("data-gs-width",t.attr("data-gs-width")).attr("data-gs-height",t.attr("data-gs-height")).show(),n.el=e.placeholder},s=function(){var t=$(this);n.el=t,e.placeholder.hide(),t.attr("data-gs-x",n.x).attr("data-gs-y",n.y).attr("data-gs-width",n.width).attr("data-gs-height",n.height).removeAttr("style"),e._update_container_height(),e.container.trigger("change",[e.grid.get_dirty_nodes()]),e.grid.end_update()};t.draggable({handle:this.opts.handle,scroll:!0,appendTo:"body",start:h,stop:s,drag:function(t,i){var h=Math.round(i.position.left/o),s=Math.floor((i.position.top+a/2)/a);e.grid.can_move_node(n,h,s,n.width,n.height)&&(e.grid.move_node(n,h,s),e._update_container_height())}}).resizable({autoHide:!this.opts.always_show_resize_handle,handles:"se",minHeight:this.opts.cell_height-10,minWidth:70,start:h,stop:s,resize:function(t,i){var h=Math.round(i.size.width/o),s=Math.round(i.size.height/a);e.grid.can_move_node(n,n.x,n.y,h,s)&&(e.grid.move_node(n,n.x,n.y,h,s),e._update_container_height())}}),(n.no_move||this._is_one_column_mode())&&t.draggable("disable"),(n.no_resize||this._is_one_column_mode())&&t.resizable("disable"),t.attr("data-gs-locked",n.locked?"yes":null)},a.prototype.set_animation=function(t){t?this.container.addClass("grid-stack-animate"):this.container.removeClass("grid-stack-animate")},a.prototype.add_widget=function(t,e,i,n,o,a){t=$(t),"undefined"!=typeof e&&t.attr("data-gs-x",e),"undefined"!=typeof i&&t.attr("data-gs-y",i),"undefined"!=typeof n&&t.attr("data-gs-width",n),"undefined"!=typeof o&&t.attr("data-gs-height",o),"undefined"!=typeof a&&t.attr("data-gs-auto-position",a?"yes":null),this.container.append(t),this._prepare_element(t),this._update_container_height()},a.prototype.will_it_fit=function(t,e,i,n,o){var a={x:t,y:e,width:i,height:n,auto_position:o};return this.grid.can_be_placed_with_respect_to_height(a)},a.prototype.remove_widget=function(t){t=$(t);var e=t.data("_gridstack_node");this.grid.remove_node(e),t.remove(),this._update_container_height()},a.prototype.remove_all=function(){e.each(this.grid.nodes,function(t){t.el.remove()}),this.grid.nodes=[],this._update_container_height()},a.prototype.resizable=function(t,e){return t=$(t),t.each(function(t,i){i=$(i);var n=i.data("_gridstack_node");"undefined"!=typeof n&&(n.no_resize=!e,i.resizable(n.no_resize?"disable":"enable"))}),this},a.prototype.movable=function(t,e){return t=$(t),t.each(function(t,i){i=$(i);var n=i.data("_gridstack_node");"undefined"!=typeof n&&(n.no_move=!e,i.draggable(n.no_move?"disable":"enable"))}),this},a.prototype.locked=function(t,e){return t=$(t),t.each(function(t,i){i=$(i);var n=i.data("_gridstack_node");"undefined"!=typeof n&&(n.locked=e||!1,i.attr("data-gs-locked",n.locked?"yes":null))}),this},a.prototype._update_element=function(t,e){t=$(t).first();var i=t.data("_gridstack_node");if("undefined"!=typeof i){var n=this;n.grid.clean_nodes(),n.grid.begin_update(i),e.call(this,t,i),n._update_container_height(),n.container.trigger("change",[n.grid.get_dirty_nodes()]),n.grid.end_update()}},a.prototype.resize=function(t,e,i){this._update_element(t,function(t,n){e=null!=e&&"undefined"!=typeof e?e:n.width,i=null!=i&&"undefined"!=typeof i?i:n.height,this.grid.move_node(n,n.x,n.y,e,i)})},a.prototype.move=function(t,e,i){this._update_element(t,function(t,n){e=null!=e&&"undefined"!=typeof e?e:n.x,i=null!=i&&"undefined"!=typeof i?i:n.y,this.grid.move_node(n,e,i,n.width,n.height)})},a.prototype.cell_height=function(t){return"undefined"==typeof t?this.opts.cell_height:(t=parseInt(t),void(t!=this.opts.cell_height&&(this.opts.cell_height=t||this.opts.cell_height,this._update_styles())))},a.prototype.cell_width=function(){var t=this.container.find("."+this.opts.item_class).first();return Math.ceil(t.outerWidth()/t.attr("data-gs-width"))},t.GridStackUI=a,t.GridStackUI.Utils=i,$.fn.gridstack=function(t){return this.each(function(){$(this).data("gridstack")||$(this).data("gridstack",new a(this,t))})}}(window,_);
//# sourceMappingURL=gridstack.min.map